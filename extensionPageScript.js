(()=>{var e,t={66801:(e,t,n)=>{"use strict";const r=!1,o="https://web.telegram.org/a/";function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(89412);class s{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"*";this.target=e,this.onUpdate=t,this.channel=n,this.targetOrigin=r,i(this,"requestStates",new Map),i(this,"requestStatesByCallback",new Map)}destroy(){}init(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.postMessage({type:"init",args:t})}request(e){const{requestStates:t,requestStatesByCallback:n}=this,r=Date.now().toString(36)+Math.random().toString(36).slice(2),o={type:"callMethod",messageId:r,...e},i={messageId:r},s=new Promise(((e,t)=>{Object.assign(i,{resolve:e,reject:t})}));if("function"==typeof o.args[o.args.length-1]){o.withCallback=!0;const e=o.args.pop();i.callback=e,n.set(e,i)}return t.set(r,i),s.catch((()=>{})).finally((()=>{t.delete(r),i.callback&&n.delete(i.callback)})),this.postMessage(o),s}cancelCallback(e){e.isCanceled=!0;const{messageId:t}=this.requestStatesByCallback.get(e)||{};t&&this.postMessage({type:"cancelProgress",messageId:t})}onMessage(e){const{requestStates:t,channel:n}=this;if(e.channel===n)if("update"===e.type&&this.onUpdate&&this.onUpdate(e.update),"methodResponse"===e.type){const n=t.get(e.messageId);n&&(e.error?n.reject(e.error):n.resolve(e.response))}else if("methodCallback"===e.type){var r;const n=t.get(e.messageId);null==n||null===(r=n.callback)||void 0===r||r.call(n,...e.callbackArgs)}else if("unhandledError"===e.type){var o;throw new Error(null===(o=e.error)||void 0===o?void 0:o.message)}}postMessage(e){e.channel=this.channel,this.target===window?this.target.postMessage(e,this.targetOrigin):this.target.postMessage(e)}}let a;function c(e){if(a){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return a.request({name:e,args:n})}!function(e){if(r){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];console.error(`[DEBUG][${e}]`,...n)}}("API is not initialized")}const l=window.open;let u;function d(e){var t;const n=null===(t=e.target)||void 0===t?void 0:t.closest("a");n&&f(n.href)&&e.preventDefault()}function h(e){if(f(e))return null;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return l(e,...n)}function f(e){if("string"!=typeof e||!e.startsWith("ton://transfer/"))return!1;try{const t=new URL(e),n={to:t.pathname.replace("//transfer/",""),amount:t.searchParams.get("amount"),text:t.searchParams.get("text")};return c("prepareTransaction",{to:n.to,amount:n.amount,comment:n.text}),!0}catch(e){return!1}}function p(e){const t=document.createElement("div");t.id="ton-magic-badge",t.style.position="fixed",t.style.zIndex="999",t.style.top="0",t.style.background="#3390ec",t.style.width="100%",t.style.height="28px",t.style.lineHeight="28px",t.style.textAlign="center",t.style.fontSize="14px",t.style.fontFamily='system-ui, -apple-system, "system-ui", "Helvetica Neue", sans-serif',t.style.color="white",t.innerHTML=e,document.body.prepend(t)}var R,E,v,m,g,w;n(16885),n(50780),function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",e[e.MANIFEST_NOT_FOUND_ERROR=2]="MANIFEST_NOT_FOUND_ERROR",e[e.MANIFEST_CONTENT_ERROR=3]="MANIFEST_CONTENT_ERROR",e[e.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",e[e.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",e[e.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(R||(R={})),function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(E||(E={})),function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",e[e.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",e[e.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",e[e.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(v||(v={})),function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",e[e.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",e[e.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",e[e.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(m||(m={})),function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",e[e.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",e[e.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"}(g||(g={})),function(e){e.MAINNET="-239",e.TESTNET="-3"}(w||(w={}));function y(){return{platform:O(),appName:"MyTonWallet",appVersion:"1.15.0",maxProtocolVersion:2,features:["SendTransaction",{name:"SendTransaction",maxMessages:4}]}}function O(){const{userAgent:e,platform:t}=window.navigator;let n;return-1!==["macOS","Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(t)?n="mac":-1!==["iPhone"].indexOf(t)?n="iphone":-1!==["iPad","iPod"].indexOf(t)?n="ipad":-1!==["Win32","Win64","Windows","WinCE"].indexOf(t)?n="windows":(/Android/.test(e)||/Linux/.test(t))&&(n="linux"),n}function b(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class _{constructor(e){this.apiConnector=e,b(this,"deviceInfo",y()),b(this,"protocolVersion",2),b(this,"isWalletBrowser",!1),b(this,"callbacks",void 0),b(this,"lastGeneratedId",0),b(this,"unloadEventListener",(()=>{this.request("deactivate")})),this.callbacks=[]}async connect(e,t){const n=++this.lastGeneratedId;if(e>this.protocolVersion)return _.buildConnectError(n,"Unsupported protocol version",R.BAD_REQUEST_ERROR);const r=await this.request("connect",[t,n]);return"connect"===(null==r?void 0:r.event)&&(r.payload.device=y(),this.addEventListeners()),this.emit(r||_.buildConnectError(n))}async restoreConnection(){const e=++this.lastGeneratedId,t=await this.request("reconnect",[e]);return"connect"===(null==t?void 0:t.event)&&(t.payload.device=y(),this.addEventListeners()),this.emit(t||_.buildConnectError(e))}async send(e){const{id:t}=e,n=await this.request(e.method,[e]);return"disconnect"===e.method&&this.removeEventListeners(),n||{error:{code:0,message:"Unknown error"},id:t}}listen(e){return this.callbacks.push(e),()=>{this.callbacks=this.callbacks.filter((t=>t!==e))}}onDisconnect(){const e=++this.lastGeneratedId;this.emit({event:"disconnect",id:e,payload:{}}),this.removeEventListeners()}request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.apiConnector.request({name:`tonConnect_${e}`,args:t})}static buildConnectError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unknown error";return{event:"connect_error",id:e,payload:{code:(arguments.length>2?arguments[2]:void 0)||R.UNKNOWN_ERROR,message:t}}}emit(e){return this.callbacks.forEach((t=>t(e))),e}addEventListeners(){this.removeEventListeners(),window.addEventListener("beforeunload",this.unloadEventListener)}removeEventListeners(){window.removeEventListener("beforeunload",this.unloadEventListener)}destroy(){this.removeEventListeners(),this.callbacks=[],this.apiConnector.destroy()}}class N{constructor(){var e,t,n;e=this,t="channels",n=new Map,(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}on(e,t){return this.resolveChannel(e).addCallback(t),this}removeListener(e,t){return this.resolveChannel(e).removeCallback(t),this}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.resolveChannel(e).runCallbacks(...n),this}resolveChannel(e){let t=this.channels.get(e);return t||(t=function(){const e=new Set;function t(t){e.delete(t)}return{runCallbacks:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.forEach((e=>{e(...n)}))},addCallback:function(n){return e.add(n),()=>{t(n)}},removeCallback:t,hasCallbacks:function(){return Boolean(e.size)}}}(),this.channels.set(e,t)),t}}function T(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class S extends N{constructor(e){super(),this.apiConnector=e,T(this,"isMyTonWallet",!0),T(this,"isTonWallet",!0)}destroy(){this.apiConnector.destroy()}send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.apiConnector.request({name:e,args:t})}}const P=window.origin,U=(a=function(e,t,n,r){const o=new s(e,t,"MyTonWallet_pageConnector",r);function i(e){let{data:t}=e;o.onMessage(t)}return e.addEventListener("message",i),o.destroy=()=>{e.removeEventListener("message",i)},o}(window,(function(e){const{type:t,...n}=e;if("updateTonMagic"!==t)if("updateDeeplinkHook"!==t){var r;if("disconnectDapp"===t){const{origin:t}=e;t===P&&A.onDisconnect()}if("updateAccounts"!==t)C.emit(t,n);else{const{accounts:t}=e;C.emit("accountsChanged",t)}}else{const{isEnabled:t}=e;(r=t)!==Boolean(u)&&(r?(window.addEventListener("click",d,!1),window.open=h):(window.removeEventListener("click",d),window.open=l),u=r)}else{const{isEnabled:t}=e;!async function(e,t){if(window.location.href.startsWith(o)){if(e){const e=document.querySelector('script[src^="main."]').getAttribute("src"),t=await fetch(`https://ton.org/app/magic-sources.json?${Date.now()}`),n=await t.json(),r=n.find((e=>e.startsWith("main.")&&e.endsWith(".js"))),i=await window.caches.open("tt-assets"),s=await i.match(e);if(s){const e=await s.text();if(null==e?void 0:e.endsWith(`${r}.map`))return}p("Loading <b>TON magic</b>...");const a=await Promise.all(n.map((async e=>{const t=await fetch(`https://ton.org/app/${e}`);if(200!==t.status)throw new Error(`[TON Wallet] Failed to load magic: ${t.statusText}. File: ${e}`);return[e,new Response(await t.blob(),{headers:t.headers,status:t.status,statusText:t.statusText})]})));await Promise.all(a.map((async t=>{let[n,r]=t;if(n.startsWith("main.")){if(n.endsWith(".js"))await i.put(`${o}${e}`,r.clone());else if(n.endsWith(".css")){const e=document.querySelector("link[rel=stylesheet]").getAttribute("href");await i.put(`${o}${e}`,r.clone())}}else await i.put(`${o}${n}`,r.clone())}))),localStorage.setItem("ton:magicRevision",r)}else{if(!localStorage.getItem("ton:magicRevision"))return;localStorage.removeItem("ton:magicRevision"),await window.caches.delete("tt-assets")}t()}else window.location.href.startsWith("https://web.telegram.org/k/")&&function(e){const t=document.getElementById("column-left"),n=document.getElementById("column-center");if(e)p("Switch to <b>Z version</b> in the menu to take advantage of <b>TON magic</b>."),t&&(t.style.top="28px"),n&&(n.style.top="28px");else{const e=document.getElementById("ton-magic-badge");e&&(e.remove(),t&&(t.style.top=""),n&&(n.style.top=""))}}(e)}(t,(async()=>{await c("flushMemoryCache"),window.location.reload()}))}}),0,window.location.href),a),C=function(e){const t=new S(e);if(window.ton)try{window.ton.destroy()}catch(e){console.log(e)}return window.tonProtocolVersion=1,window.ton=t,window.myTonWallet=t,window.dispatchEvent(new Event("tonready")),t}(U),A=function(e){const t=new _(e);return window.mytonwallet={tonconnect:t},t}(U)},16885:function(e,t,n){var r=n(88924).Buffer;!function(t,n){"use strict";e.exports?e.exports=n():(t.nacl||(t.nacl={}),t.nacl.util=n())}(this,(function(){"use strict";var e={};function t(e){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(e){if("string"!=typeof e)throw new TypeError("expected string");var t,n=unescape(encodeURIComponent(e)),r=new Uint8Array(n.length);for(t=0;t<n.length;t++)r[t]=n.charCodeAt(t);return r},e.encodeUTF8=function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(String.fromCharCode(e[t]));return decodeURIComponent(escape(n.join("")))},"undefined"==typeof atob?void 0!==r.from?(e.encodeBase64=function(e){return r.from(e).toString("base64")},e.decodeBase64=function(e){return t(e),new Uint8Array(Array.prototype.slice.call(r.from(e,"base64"),0))}):(e.encodeBase64=function(e){return new r(e).toString("base64")},e.decodeBase64=function(e){return t(e),new Uint8Array(Array.prototype.slice.call(new r(e,"base64"),0))}):(e.encodeBase64=function(e){var t,n=[],r=e.length;for(t=0;t<r;t++)n.push(String.fromCharCode(e[t]));return btoa(n.join(""))},e.decodeBase64=function(e){t(e);var n,r=atob(e),o=new Uint8Array(r.length);for(n=0;n<r.length;n++)o[n]=r.charCodeAt(n);return o}),e}))},88924:()=>{},55024:()=>{}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,n,o,i)=>{if(!n){var s=1/0;for(u=0;u<e.length;u++){for(var[n,o,i]=e[u],a=!0,c=0;c<n.length;c++)(!1&i||s>=i)&&Object.keys(r.O).every((e=>r.O[e](n[c])))?n.splice(c--,1):(a=!1,i<s&&(s=i));if(a){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,o,i]},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={570:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[s,a,c]=n,l=0;if(s.some((t=>0!==e[t]))){for(o in a)r.o(a,o)&&(r.m[o]=a[o]);if(c)var u=c(r)}for(t&&t(n);l<s.length;l++)i=s[l],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(u)},n=self.webpackChunkmytonwallet=self.webpackChunkmytonwallet||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=r.O(void 0,[780,412],(()=>r(66801)));o=r.O(o)})();
//# sourceMappingURL=extensionPageScript.js.map